---
title: "Go ì‹¤í–‰ íŒŒì¼ì— ë¦¬ì†ŒìŠ¤ íŒŒì¼ í¬í•¨ì‹œí‚¤ê¸°"
category: Go
toc: true
toc_label: "ì´ í˜ì´ì§€ ëª©ì°¨"
---

Go ì‹¤í–‰ íŒŒì¼ì—ì„œ ë¦¬ì†ŒìŠ¤ íŒŒì¼ë“¤ì„ í¬í•¨ì‹œí‚¤ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.

## í•„ìš”ì„±
íŒ€ ì„œë²„ì— submit ëœ PGP íŒŒì¼ì„ decrypt í•´ ì£¼ëŠ” ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ì˜€ëŠ”ë°, ë¦¬ì†ŒìŠ¤ íŒŒì¼ë“¤ì„ íŒŒì¼ êµ¬ì¡°ë¡œ í•¨ê»˜ ë°°í¬í•  ìˆ˜ë„ ìˆì§€ë§Œ ë³€ê²½ë  í•„ìš”ê°€ ì—†ëŠ” ë¦¬ì†ŒìŠ¤ë“¤ì€ í¸ì˜ìƒ ì‹¤í–‰ íŒŒì¼ì— í¬í•¨ì‹œì¼œì„œ ë°°í¬í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.  
ì´ë ‡ê²Œ í•˜ë©´ ë¦¬ì†ŒìŠ¤ íŒŒì¼ì„ ì„ì˜ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆê³ , ì´í›„ ì„œë²„ í”„ë¡œê·¸ë¨ì´ë‚˜ ë¦¬ì†ŒìŠ¤ íŒŒì¼ë“¤ì´ ë³€ê²½ëœ ê²½ìš°ì—ë„ ì‹¤í–‰ íŒŒì¼ í•œ ê°œë§Œ ë°°í¬í•˜ë©´ ë˜ë¯€ë¡œ ì•„ì£¼ í¸ë¦¬í•˜ë‹¤.  
Go ì–¸ì–´ëŠ” íŠ¹íˆ ì´ëŸ° ê²½ìš°ì— ìœ ë¦¬í•œ ì ì´ ìˆëŠ” ê²ƒ ê°™ë‹¤.

## ê¸°ì¡´ ë°©ë²•
Go ì–¸ì–´ ìì²´ì ìœ¼ë¡œ embed ì‹œì¼œì£¼ëŠ” ëª¨ë“ˆì´ ì—†ì—ˆìœ¼ë¯€ë¡œ, ì™¸ë¶€ íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í–ˆì–´ì•¼ ëë‹¤.  
ì´ë¥¼ ìœ„í•œ ì—¬ëŸ¬ íŒ¨í‚¤ì§€ë“¤ì´ ìˆì—ˆì§€ë§Œ, ê·¸ ì¤‘ì—ì„œ ë‚˜ëŠ” ì£¼ë¡œ [Go rice](https://github.com/GeertJohan/go.rice) íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í–ˆì—ˆë‹¤. ì•„ë˜ëŠ” ê°„ë‹¨í•œ ì‚¬ìš© ì˜ˆì´ë‹¤.
1. ì•„ë˜ì™€ ê°™ì´ ë””ë ‰êµ¬ì¡°ì™€ íŒŒì¼ì„ ìƒì„±í•˜ì˜€ë‹¤.
   ```
   â”œâ”€templates/index.html
   â””â”€main.go
   ```
1. ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ `templates` ë””ë ‰í„°ë¦¬ì˜ íŒŒì¼ë“¤ì˜ ë‚´ìš©ì„ í¬í•¨í•˜ëŠ” `rice-box.go` íŒŒì¼ì´ ìƒì„±ëœë‹¤.
   ```shell
   $ rice embed-go
   ```
1. ì•„ë˜ëŠ” main.go íŒŒì¼ì—ì„œì˜ ì‚¬ìš©ë²• ì˜ˆì´ë‹¤.
   ```go
   package main

   import (
       "html/template"
       "net/http"

       rice "github.com/GeertJohan/go.rice"
       "github.com/gin-gonic/contrib/renders/multitemplate"
       "github.com/gin-gonic/contrib/sessions"
       "github.com/gin-gonic/gin"
   )

   func main() {
       router := gin.New()

       // Home í•¸ë“¤ëŸ¬
       router.GET("/", homeHandler)

       // í…œí”Œë¦¿ html íŒŒì¼ë“¤ì„ ë¡œë”©
       router.HTMLRender = loadTemplates()

       router.Run(":8080")
   }

   // í…œí”Œë¦¿ html íŒŒì¼ë“¤ì„ embeddingí•´ì„œ ë¡œë”©í•œë‹¤.
   func loadTemplates() multitemplate.Render {
       r := multitemplate.New()

       templateBox, err := rice.FindBox("templates")
       if err != nil {
           return r
       }

       list := [...]string{"index.html"}
       for _, x := range list {
           templateString, err := templateBox.String(x)
           if err != nil {
               continue
           }
           tmplMessage, err := template.New(x).Parse(templateString)
           if err != nil {
               continue
           }
           r.Add(x, tmplMessage)
       }

      return r
   }

   func homeHandler(ctx *gin.Context) {
       ctx.HTML(http.StatusOK, "index.html", nil)
   }
   ```

ê·¸ëŸ°ë° ì´ë²ˆì— PGP íŒŒì¼ì„ decrypt í•´ ì£¼ëŠ” ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•  ë•Œì—ë„ ê¸°ì¡´ rice íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ì´ìš©í•˜ì—¬ ê¸ˆë°© êµ¬í˜„ì€ í–ˆëŠ”ë°, ê¸°ì¡´ì— ì—†ë˜ `favicon`ì„ ì´ ë°©ë²•ìœ¼ë¡œ í¬í•¨ì‹œì¼œë ¤ê³  í•˜ë‹ˆê¹ ì˜ì™¸ë¡œ ì˜ ë˜ì§€ ì•Šì•˜ë‹¤.  
ê·¸ë˜ì„œ ë‹¤ë¥¸ ë°©ë²•ì€ ì—†ì„ê¹Œ í•˜ê³  êµ¬ê¸€ë§ í•´ë³´ë‹ˆ, ìµœê·¼ì— ë‚˜ì˜¨ Go ë²„ì „ 1.16 ë¶€í„°ëŠ” `embed` íŒ¨í‚¤ì§€ê°€ ê¸°ë³¸ ë‚´ì¥ë˜ì—ˆê³  ì´ë¥¼ ì´ìš©í•˜ì—¬ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ì„œ ì‹œë„í•´ ë³´ì•˜ë‹¤. ğŸ¤”

## embed ëª¨ë“ˆì„ ì´ìš©í•œ ë°©ë²•
ì•ì„œ ì–¸ê¸‰í–ˆë“¯ì´ Go ë²„ì „ 1.16ë¶€í„°ëŠ” ìì²´ì ìœ¼ë¡œ embed ëª¨ë“ˆì„ ì§€ì›í•˜ë¯€ë¡œ, ì™¸ë¶€ íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. [Go embed íŒ¨í‚¤ì§€](https://pkg.go.dev/embed) í˜ì´ì§€ì— ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•ì´ ë‚˜ì™€ ìˆë‹¤.

## Ginì— ì ìš© ì˜ˆì œ
1. ì•„ë˜ì™€ ê°™ì´ ë””ë ‰êµ¬ì¡°ì™€ íŒŒì¼ì„ ìƒì„±í•˜ì˜€ë‹¤.
   ```
   â”œâ”€static
   â”‚   â”œâ”€css/style.css
   â”‚   â”œâ”€icon/favicon.png
   â”‚   â””â”€template/index.html
   â””â”€main.go
   ```
1. `style.css` íŒŒì¼ì˜ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ì˜€ë‹¤.
   ```css
   body {
       background-color: lightgray;
   }
   ```
1. ì•„ë˜ì™€ ê°™ì´ `main.go` íŒŒì¼ì„ ì‘ì„±í•˜ì˜€ë‹¤.
   ```go
   package main

   import (
       "embed"
       "fmt"
       "html/template"
       "net/http"
       "github.com/gin-gonic/gin"
   )

   // "static" ë””ë ‰í„°ë¦¬ embed
   var (
       //go:embed static
       embedFS embed.FS
   )

   func main() {
       router := gin.Default()

       // HTML í…œí”Œë¦¿ íŒŒì¼ë“¤ì„ ë¡œë“œí•´ì„œ ì„¸íŒ…í•œë‹¤.
       template, err := template.ParseFS(embedFS, "static/template/*")
       if err != nil {
           fmt.Println("Fail to load template.", err)
           return
       }
       router.SetHTMLTemplate(template)

       // Home í•¸ë“¤ëŸ¬
       router.GET("/", homeHandler)

       // Static embedded íŒŒì¼ë“¤ì„ serve
       router.GET("/static/*filepath", func(c *gin.Context) {
           c.FileFromFS(c.Request.URL.Path, http.FS(embedFS))
       })
       router.Run()
   }

   func homeHandler(ctx *gin.Context) {
       ctx.HTML(http.StatusOK, "index.html", nil)
   }
   ```

   ìœ„ì˜ ì½”ë“œì—ì„œì²˜ëŸ¼ ì•„ë˜ì™€ ê°™ì´ `//go:embed ë””ë ‰í„°ë¦¬` ë‚´ìš©ì„ ì¶”ê°€í•´ ì£¼ë©´ ì´ ë””ë ‰í„°ë¦¬ì˜ ëª¨ë“  íŒŒì¼ë“¤ì´ í¬í•¨ëœë‹¤.
   ```go
   //go:embed static
   embedFS embed.FS
   ```
   ì´í›„ `embed.FS`ë¥¼ ì´ìš©í•˜ì—¬ SetHTMLTemplate() í•¨ìˆ˜ë¥¼ ìˆ˜í–‰í•´ ì£¼ê³ , ì•„ë˜ì™€ ê°™ì´ embedded íŒŒì¼ë“¤ì„ serve í•´ ì£¼ë©´, ì´í›„ë¶€í„°ëŠ” embedded ëœ íŒŒì¼ë“¤ì„ ë°”ë¡œ ì—‘ì„¸ìŠ¤í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
   ```go
   router.GET("/static/*filepath", func(c *gin.Context) {
       c.FileFromFS(c.Request.URL.Path, http.FS(embedFS))
   })
   ```
1. `index.html` íŒŒì¼ì˜ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ì˜€ë‹¤.
   ```html
   <!doctype html>
   <html lang="en">
       <head>
           <meta charset="utf-8">
           <title>Go gin embed test</title>
           <link rel="stylesheet" href="/static/css/style.css">
           <link rel="icon" href="/static/icon/favicon.png" type="image/png">
       </head>
       <body>
           <h1>Hello! Go gin embed.</h1>
       </body>
   </html>
   ```
   HTML í…œí”Œë¦¿ íŒŒì¼ì—ì„œë„ ìœ„ì˜ ì˜ˆì—ì„œ ë³´ë“¯ì´ `/static/`ì™€ ê°™ì´ ë¦¬ì†ŒìŠ¤ íŒŒì¼ë“¤ì˜ ê²½ë¡œë¥¼ ë””ë ‰í„°ë¦¬ì™€ íŒŒì¼ ê²½ë¡œë¡œ ì—‘ì„¸ìŠ¤í•  ìˆ˜ ìˆê²Œ ëœë‹¤. (ìœ„ì˜ ì˜ˆì—ì„œëŠ” **style.css**, **favicon.png** íŒŒì¼ ì‚¬ìš©)

ë¹Œë“œí•˜ë©´ ê²°ê³¼ë¡œ ì‹¤í–‰ íŒŒì¼ í•œ ê°œë§Œ ë‚˜ì˜¤ê³ , ì´ íŒŒì¼ì„ ì‹¤í–‰í•œ í›„ì— ì›¹ í˜ì´ì§€ì— ì ‘ì†í•´ ë³´ë©´ index.html, style.css, favicon.png íŒŒì¼ë“¤ì´ ë‚´ìš©ì´ ì •ìƒì ìœ¼ë¡œ ë°˜ì˜ë˜ì–´ì„œ ë‚˜ì˜´ì„ í™•ì¸í•˜ì˜€ë‹¤.  
Go ìì²´ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” embed íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ë‹ˆ í™•ì‹¤íˆ rice íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ í¸ë¦¬í•´ì¡Œë‹¤. ğŸ»
