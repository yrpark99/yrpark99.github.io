---
title: "Go/Pythonìœ¼ë¡œ Outlook ë©”ì¼ ë³´ë‚´ê¸°"
category: [Go, Python]
toc: true
toc_label: "ì´ í˜ì´ì§€ ëª©ì°¨"
---

Goë‚˜ Pythonì„ ì‚¬ìš©í•˜ì—¬ Outlookìœ¼ë¡œ ë©”ì¼ì„ ë³´ë‚´ëŠ” ë°©ë²•ì„ ê³µìœ í•œë‹¤. (OLE ì´ìš©)

<br>
`Go`ë‚˜ `Python`ìœ¼ë¡œ ë©”ì¼ì„ ë³´ë‚´ëŠ” ë°©ë²•ì€ ë§ì´ ì•Œë ¤ì ¸ìˆê³ , ì‹¤ì œë¡œ ë‚˜ë„ ì´ ë°©ë²•ì„ ì´ìš©í•˜ì—¬ ëª‡ ê°€ì§€ ì—…ë¬´ ìë™í™”ë¥¼ í•˜ê³  ìˆë‹¤. ê·¸ëŸ°ë° ì—…ë¬´ íŠ¹ì„±ìƒ ë¬´ì¡°ê±´ ë©”ì¼ì„ ë³´ë‚´ë©´ ê³¤ë€í•˜ê³  ë³´ë‚´ê¸° ì „ì— ì‚¬ì „ ì ê²€ì´ë‚˜ ìë™í™”ê¸° ì•ˆë˜ëŠ” ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš°ë„ ìˆë‹¤.  
ì´ëŸ° ê²½ìš°ì—ëŠ” Outlook ë©”ì¼ í™”ë©´ì„ ë°œì†¡ì€ í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë„ìš´ í›„, ì ê²€ ë° ìˆ˜ì •ì„ í•œ í›„ ë°œì†¡í•˜ë©´ í¸í•œë°, Goë‚˜ Pythonìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ëª°ëë‹¤ê°€ ì´ë²ˆì— <mark style='background-color: #ffdce0'>OLE</mark>(Object Linking and Embedding)ë¥¼ ì´ìš©í•œ ë°©ë²•ì„ ì•Œê²Œ ë˜ì–´ ì •ë¦¬í•´ ë³¸ë‹¤.

<br>
ì‚¬ì‹¤ ë‚˜ëŠ” ì´ëŸ° ìš©ë„ì˜ ê²ƒì€ Outlookì—ì„œ `VBA`ë¡œ ì‘ì„±í–ˆì—ˆëŠ”ë°, VBAë¡œ êµ¬í˜„ì´ í˜ë“  ê²ƒì€ Goë‚˜ Pythonìœ¼ë¡œ êµ¬í˜„í•´ì„œ í˜¸ì¶œí•˜ê³  ìˆì—ˆë‹¤. ì¦‰, ì´ ë°©ë²•ìœ¼ë¡œë„ ì›í•˜ëŠ” ì—…ë¬´ ìë™í™”ëŠ” ë‹¬ì„±í–ˆì—ˆì§€ë§Œ êµ¬í˜„ì´ VBAì™€ Go/Pythonìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§€ëŠ” ë¶ˆí¸í•¨ì´ ìˆì—ˆëŠ”ë° (ë”êµ¬ë‚˜ ì•„ë¬´ë˜ë„ VBAëŠ” ìµìˆ™í•˜ì§€ ì•Šìœ¼ë‹ˆ), Goë‚˜ Pythonìœ¼ë¡œ êµ¬í˜„í•˜ë©´ VBAë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ì¢€ ë” í¸ë¦¬í•œ í™˜ê²½ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆê² ë‹¤.ğŸ˜‹)

## Pythonìœ¼ë¡œ ë©”ì¼ ë³´ë‚´ê¸°
Gmail SMTPë¥¼ ì´ìš©í•œ ì˜ˆì œì´ë‹¤. ë¨¼ì € Gmailì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì‚¬ì „ ì¤€ë¹„ê°€ í•„ìš”í•˜ë‹¤.
1. Gmail ì„¤ì •ì—ì„œ "ì „ë‹¬ ë° POP/IMAP" -> "IMAP ì‚¬ìš©"ì„ ì²´í¬í•œë‹¤.
1. https://myaccount.google.com/security í˜ì´ì§€ì—ì„œ "2ë‹¨ê³„ ì¸ì¦" í•­ëª©ì„ í´ë¦­í•˜ì—¬ ì•ˆë‚´ëŒ€ë¡œ ì§„í–‰í•œë‹¤.
1. 2ë‹¨ê³„ ì¸ì¦ì´ ì™„ë£Œë˜ë©´ ë‹¤ì‹œ https://myaccount.google.com/security í˜ì´ì§€ì—ì„œ "ì•± ë¹„ë°€ë²ˆí˜¸" í•­ëª©ì„ í´ë¦­í•˜ì—¬ ë³¸ì¸ì´ ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ì•±ê³¼ ê¸°ê¸°ë¥¼ ì„ íƒí•œ í›„ (ì•±ì€ "ë©”ì¼"ë¡œ ì„ íƒ), "ìƒì„±" ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, ë¹„ë°€ë²ˆí˜¸ê°€ ìƒì„±ëœë‹¤.
1. ìœ„ì—ì„œ ì–»ì€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•„ë˜ Python ì˜ˆì œ ì½”ë“œì—ì„œ SMTP login ì‹œ Gmail ID/PWì— ì‚¬ìš©í•˜ë©´ ëœë‹¤.

ì•„ë˜ ì˜ˆì œ ì½”ë“œë¥¼ ì°¸ì¡°í•œë‹¤.
```python
import smtplib
from email.mime.text import MIMEText

smtp = smtplib.SMTP('smtp.gmail.com', 587)
smtp.starttls()
smtp.login('Gmail ID', 'Gmail PW')

mailBodyMsg = "<font style=\"font-family: 'ë§‘ì€ ê³ ë”•'; font-size: 10pt; \"><font color='#1f4e79'>ë©”ì¼ ë³¸ë¬¸</font>"
msg = MIMEText(mailBodyMsg, 'html')
msg['Subject'] = 'ë©”ì¼ ì œëª©'
smtp.sendmail("", "ìˆ˜ì‹ ì¸ë©”ì¼ì£¼ì†Œ", msg.as_string())
smtp.quit()
```

## Goë¡œ ë©”ì¼ ë³´ë‚´ê¸°
### ì˜ˆì œ 1
ì•„ë˜ ì˜ˆì œëŠ” Outlookì„ ì´ìš©í•˜ì—¬ ë©”ì¼ì„ ë³´ë‚¸ë‹¤. Outlook SMTPëŠ” LOGIN ë°©ì‹ì¸ë°, SMTP íŒ¨í‚¤ì§€ëŠ” PLAIN authë§Œ ì§€ì›í•˜ë¯€ë¡œ, smtp.Auth ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ loginì„ í•˜ì˜€ë‹¤.
```go
package main

import (
    "errors"
    "log"
    "net/smtp"
    "strconv"
)

func main() {
    server := "smtp-mail.outlook.com"
    port := 25
    user := "ë³¸ì¸ë©”ì¼ì£¼ì†Œ"
    pw := "ë³¸ì¸ë©”ì¼ì•”í˜¸"
    dest := "ìˆ˜ì‹ ì¸ë©”ì¼ì£¼ì†Œ"
    cc := "ì°¸ì¡°ì¸ë©”ì¼ì£¼ì†Œ"
    endpoint := server + ":" + strconv.Itoa(port)
    auth := myLoginAuth(user, pw)
    from := user
    to := []string{dest}
    subjectMsg := "ë©”ì¼ ì œëª©"
    bodyMsg := "ë©”ì¼ ë³¸ë¬¸"
    headerBlank := "\r\n"
    FromAddr := "From: " + from + headerBlank
    toAddr := "To: " + dest + headerBlank
    ccAddr := "Cc: " + cc + headerBlank
    headerSubject := "Subject: " + subjectMsg + headerBlank
    body := bodyMsg + headerBlank
    msg := []byte(FromAddr + toAddr + headerSubject + ccAddr + headerBlank + body)
    err := smtp.SendMail(endpoint, auth, from, to, msg)
    if err != nil {
        log.Fatal(err)
    }
}
type loginAuth struct {
    username, password string
}
func myLoginAuth(username, password string) smtp.Auth {
    return &loginAuth{username, password}
}
func (a *loginAuth) Start(server *smtp.ServerInfo) (string, []byte, error) {
    return "LOGIN", []byte(a.username), nil
}
func (a *loginAuth) Next(fromServer []byte, more bool) ([]byte, error) {
    if more {
        switch string(fromServer) {
        case "Username:":
            return []byte(a.username), nil
        case "Password:":
            return []byte(a.password), nil
        default:
            return nil, errors.New("Unkown from server")
        }
    }
    return nil, nil
}
```

### ì˜ˆì œ 2
ì•„ë˜ ì˜ˆì œëŠ” "gopkg.in/mail.v2" íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•œ ë°©ì‹ì´ë‹¤.
```go
package main

import (
    "fmt"

    "gopkg.in/mail.v2"
)

func main {
    user := "ë³¸ì¸ë©”ì¼ì£¼ì†Œ"
    pw := "ë³¸ì¸ë©”ì¼ì•”í˜¸"
    receiver := "ìˆ˜ì‹ ì¸ë©”ì¼ì£¼ì†Œ"
    cc := "ì°¸ì¡°ì¸ë©”ì¼ì£¼ì†Œ"
    subject := "ë©”ì¼ ì œëª©"
    fileName := "ì²¨ë¶€ íŒŒì¼ ì´ë¦„"
    d := mail.NewDialer("smtp-mail.outlook.com", 25, user, pw)

    msg := mail.NewMessage()
    msg.SetHeader("From", user)
    msg.SetHeader("To", receiver)
    msg.SetHeader("Cc", cc)
    msg.SetHeader("Subject", subject)
    msg.SetBody("text/html", "<b>Hello</b> <i>world!</i>!")
    msg.Attach(fileName)

    if err := d.DialAndSend(msg); err != nil {
        fmt.Println("Fail to send an email.", err)
        return err
    }

    return nil
}
```

## Pythonìœ¼ë¡œ Outlook ë©”ì¼ íŒì—… ë„ìš°ê¸°
ì•„ë˜ ì˜ˆì œëŠ” Pythonìœ¼ë¡œ OLEë¥¼ ì´ìš©í•˜ì—¬ Outlook ë©”ì¼ íŒì—…ì„ ë„ìš°ëŠ” ì˜ˆì œì´ë‹¤. (Outlookì´ ì‹¤í–‰ ì¤‘ì´ ì•„ë‹ˆì–´ë„ ë¨)
```python
from win32com.client import Dispatch
import win32com.client as win32

outlook = win32.Dispatch('outlook.application')
mail = outlook.CreateItem(0)

mail.To = "ìˆ˜ì‹ ì¸ë©”ì¼ì£¼ì†Œ"
mail.CC = "ì°¸ì¡°ì¸ë©”ì¼ì£¼ì†Œ"
mail.Subject = "ë©”ì¼ ì œëª©"
mail.HTMLBody = "<span style='font: normal 10pt ""Malgun Gothic""; color: #1f4e79;'>ë©”ì¼ ë³¸ë¬¸<br><br>ë"
mail.Display(True)
```

ë§Œì•½ `Display` ëŒ€ì‹ ì— ì•„ë˜ì™€ ê°™ì´ `Send`ë¥¼ ì´ìš©í•˜ë©´ ë©”ì¼ íŒì—…ì„ ë„ìš°ì§€ ì•Šê³  ë°”ë¡œ ë©”ì¼ì„ ì „ì†¡í•˜ê²Œ ëœë‹¤.
```python
mail.Send()
```

## Goë¡œ Outlook ë©”ì¼ íŒì—… ë„ìš°ê¸°
ì•„ë˜ ì˜ˆì œëŠ” Goë¡œ OLEë¥¼ ì´ìš©í•˜ì—¬ Outlook ë©”ì¼ íŒì—…ì„ ë„ìš°ëŠ” ì˜ˆì œì´ë‹¤. (Outlookì´ ì‹¤í–‰ ì¤‘ì´ ì•„ë‹ˆì–´ë„ ë¨)
```go
package main

import (
    "github.com/go-ole/go-ole"
    "github.com/go-ole/go-ole/oleutil"
)

func main() {
    ole.CoInitializeEx(0, 0)
    unknown, _ := oleutil.CreateObject("Outlook.Application")
    outlook, _ := unknown.QueryInterface(ole.IID_IDispatch)
    mail := oleutil.MustCallMethod(outlook, "CreateItem", 0)
    oleutil.MustPutProperty(mail.ToIDispatch(), "To", "ìˆ˜ì‹ ì¸ë©”ì¼ì£¼ì†Œ")
    oleutil.MustPutProperty(mail.ToIDispatch(), "CC", "ì°¸ì¡°ì¸ë©”ì¼ì£¼ì†Œ")
    oleutil.MustPutProperty(mail.ToIDispatch(), "Subject", "ë©”ì¼ ì œëª©")
    oleutil.MustPutProperty(mail.ToIDispatch(), "HTMLBody", "<span style='font: normal 10pt \"Malgun Gothic\"; color: #1f4e79;'>ë©”ì¼ ë³¸ë¬¸")
    oleutil.MustCallMethod(mail.ToIDispatch(), "Display", true)
}
```

ë§Œì•½ `Display` ëŒ€ì‹ ì— ì•„ë˜ì™€ ê°™ì´ `Send`ë¥¼ ì´ìš©í•˜ë©´ ë©”ì¼ íŒì—…ì„ ë„ìš°ì§€ ì•Šê³  ë°”ë¡œ ë©”ì¼ì„ ì „ì†¡í•˜ê²Œ ëœë‹¤.
```go
    oleutil.MustCallMethod(mail.ToIDispatch(), "send")
```

ìˆ˜ì‹ ìë¥¼ ì—¬ëŸ¬ ëª… ë„£ì„ ê²½ìš°ì—ëŠ” ìˆ˜ì‹ ìì— Outlookì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ `;`ë¡œ ì—¬ëŸ¬ ëª…ì„ êµ¬ë¶„í•˜ì—¬ ì„¸íŒ…í•˜ë©´ ëœë‹¤.

íŒŒì¼ì„ ì²¨ë¶€í•˜ë ¤ë©´ ì•„ë˜ ì˜ˆì™€ ê°™ì´ í•˜ë©´ ëœë‹¤.
```go
attach := oleutil.MustGetProperty(mail.ToIDispatch(), "Attachments")
oleutil.MustCallMethod(attach.ToIDispatch(), "Add", fileNamePath)
```

ë§Œì•½ì— ìƒˆë¡œìš´ ë©”ì¼ ëŒ€ì‹ ì— ê¸°ì¡´ì— ë°›ì€ ë©”ì¼ì— ëŒ€í•œ reply ë©”ì¼ì„ ë³´ë‚´ë ¤ë©´ mail ê°ì²´ë¥¼ ì•„ë˜ ì˜ˆì™€ ê°™ì´ ì–»ìœ¼ë©´ ëœë‹¤.
```go
mail, _ := oleutil.GetProperty(item.ToIDispatch(), "Reply")
```

## Outlook OLE ë¬¸ì„œ
ì°¸ê³ ë¡œ ìœ„ì—ì„œ ì‚¬ìš©í•œ Outlook OLE ë¬¸ì„œëŠ” https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
ì´ í˜ì´ì§€ì—ì„œ `Methods` ëª©ë¡ì€ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë“¤ë¡œ, ìœ„ ì˜ˆì—ì„œëŠ” **Display**ì™€ **Send**ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.
ë˜ `Properties` ëª©ë¡ì€ ì„¤ì •í•  ìˆ˜ ìˆëŠ” í•­ëª©ë“¤ë¡œ, ìœ„ ì˜ˆì—ì„œëŠ” **To**, **CC**, **Subject**, **HTMLBody** ë“±ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.

## Python OLEë¡œ Outlook ë©”ì¼ ì½ê¸°
Pythonì—ì„œ OLEë¥¼ ì´ìš©í•˜ì—¬ Outlook ë©”ì¼ì„ ì½ê³ ì í•˜ëŠ” ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
```python
import win32com.client

olFolderInbox = 6

outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
inboxfolder = outlook.GetDefaultFolder(olFolderInbox)
messages = inboxfolder.Items
print("Total inbox mail: " + str(messages.count))

i = 1
for ms in messages:
    print("[" + str(i) + "]")
    print("sender: " + ms.SenderName)
    print("to: " + ms.To)
    print("subject: " + ms.Subject)
    print(ms.Body)
    print('\n')
    i = i + 1
```

## Go OLEë¡œ Outlook ë©”ì¼ ì½ê¸°
Goë¡œ OLEë¥¼ ì´ìš©í•˜ì—¬ Outlook ë©”ì¼ì„ ì½ê³ ì í•˜ëŠ” ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
```go
package main

import (
    "fmt"
    "github.com/go-ole/go-ole"
    "github.com/go-ole/go-ole/oleutil"
)

const olFolderInbox = 6

func main() {
    ole.CoInitializeEx(0, 0)
    unknown, _ := oleutil.CreateObject("Outlook.Application")
    outlook, _ := unknown.QueryInterface(ole.IID_IDispatch)
    namespace := oleutil.MustCallMethod(outlook, "GetNamespace", "MAPI").ToIDispatch()
    folder := oleutil.MustCallMethod(namespace, "GetDefaultFolder", olFolderInbox).ToIDispatch()
    contacts := oleutil.MustCallMethod(folder, "Items").ToIDispatch()
    count := oleutil.MustGetProperty(contacts, "Count").Value().(int32)
    for i := 1; i <= int(count); i++ {
        item, err := oleutil.GetProperty(contacts, "Item", i)
        if err != nil || item.VT != ole.VT_DISPATCH {
            continue
        }
        sender, _ := oleutil.GetProperty(item.ToIDispatch(), "SenderName")
        to, _ := oleutil.GetProperty(item.ToIDispatch(), "To")
        subject, _ := oleutil.GetProperty(item.ToIDispatch(), "Subject")
        body, _ := oleutil.GetProperty(item.ToIDispatch(), "Body")
        fmt.Println("=== MAIL", i, " ===")
        fmt.Println("sender:", sender.ToString())
        fmt.Println("to:", to.ToString())
        fmt.Println("subject:", subject.ToString())
        fmt.Println(body.ToString())
    }
}
```

## ê²°ë¡ 
ì‚¬ì‹¤ OLEëŠ” ì˜¤ë˜ì „ì— Windows í”„ë¡œê·¸ë˜ë° í•  ë•Œì—ë„ ë“¤ì–´ëŠ” ë´¤ì—ˆëŠ”ë° í•„ìš”í•œ ê²½ìš°ê°€ ì—†ì–´ì„œ ìŠì–´ë²„ë¦¬ê³  ìˆì—ˆëŠ”ë°, ì˜ì™¸ë¡œ ì´ë ‡ê²Œ Goë‚˜ Pythonìœ¼ë¡œ MS Office ë“±ì„ ì œì–´í•  ë•Œì—ë„ ì•„ì£¼ ìœ ìš©í•œ ìˆ˜ë‹¨ì„ì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ğŸ’¡  
ë˜í•œ OLEë¥¼ ì´ìš©í•˜ê²Œ ë˜ë©´ Outlookì˜ ID/PWë¥¼ ì…ë ¥í•˜ì§€ ì•Šì•„ë„ ë˜ë¯€ë¡œ, Outlook ë©”ì¼ì„ ë‹¤ë£¨ëŠ” Python/Go ë“±ì˜ ì†ŒìŠ¤ë¥¼ ë°°í¬í•˜ëŠ” ê²½ìš°ì— ì¢€ ë” í¸ë¦¬í•´ì§€ëŠ” ì¥ì ì´ ìˆë‹¤.
